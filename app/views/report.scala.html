@(reportData: ResponseAnalysisInterface)(implicit user: User, request: RequestHeader)

<p>
 	@if(reportData.globalEval(user) > 3) {
     L'entreprise a une bonne évaluation (@reportData.globalEval(user))
  	} else {
	  L'entreprise a une mauvaise évaluation (@reportData.globalEval(user))
   }
</p>
<h2>Gestion des risques</h2>
<div style="float: left">
	<img src="http://@request.host@routes.Application.chart("risk", user.email)" />
</div>
<div style="float: left">
	<table>
		<tr>
			<th>Thème</th>
			<th>Note sur 5</th>
		</tr>
		@for((form, eval) <- reportData.getRiskEval(user.email)) {
		<tr>
			<td>@form</td>
			<td>@("%.1f".format(eval))</td>
		</tr>
		}
	</table>
</div>
<div style="clear: both"></div>
<h2>Gestion du capital immatériel</h2>
<div style="float: left">
	<img src="http://@request.host@routes.Application.chart("capital", user.email)" />
</div>
<div style="clear: both"></div>

@* Textual report *@

@* 
@{for( formsGroupURI <- reportData.formsGroupsURIMap.values ) yield
*@
@{for( formsGroupURI <- reportData.formsGroups ) yield {
  val elems = reportData.filterQuestionnaires( user, formsGroupURI) match {
	case ( good, bad ) => {
	 ( for( item <- good ) yield
	 	if( item._1 != "" )
	 	 <p> Un point favorable est
	 	 <a href={ "/form?url=" + java.net.URLEncoder.encode(item._2, "utf-8") }> 
             {item._1} </a>.</p>
        else <span></span>
     ) ++ (
     for( item <- bad ) yield
    	if( item._1 != "" )
	 	 <p> Un point à améliorer est
	 	 <a href={ "/form?url=" + java.net.URLEncoder.encode(item._2, "utf-8") }> 
             {item._1} </a>.</p>
        else <span></span>
     )
    }
  }
  elems
}
}
